# .cpanel.yml
deployment:
  tasks:
    # Ù…Ø³ÛŒØ± Ù¾Ø±ÙˆÚ˜Ù‡ Ø±ÙˆÛŒ cPanel
    - export DEPLOY_DIR=/home/h330619/laravel
    - cd $DEPLOY_DIR

    # ğŸ”¹ Backup ÙØ§ÛŒÙ„ .env Ø§Ú¯Ø± Ù‚Ø¨Ù„Ø§Ù‹ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
    - if [ -f ".env" ]; then cp .env .env.backup; fi

    # ğŸ”¹ Ø¢Ù…Ø§Ø¯Ù‡ Ú©Ø±Ø¯Ù† ÙØ§ÛŒÙ„ .env Ø¯Ø± ØµÙˆØ±Øª Ù†Ø¨ÙˆØ¯
    - if [ ! -f ".env" ]; then cp .env.example .env; fi

    # ğŸ”¹ Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ÛŒ PHP
    - /usr/local/bin/composer install --no-interaction --prefer-dist --optimize-autoloader

    # ğŸ”¹ Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ÛŒ Node.js Ùˆ build ÙØ±Ø§Ù†Øªâ€ŒØ§Ù†Ø¯
    - /usr/local/bin/npm install
    - /usr/local/bin/npm run build

    # ğŸ”¹ Ø§Ø¬Ø±Ø§ÛŒ migration Ø¯ÛŒØªØ§Ø¨ÛŒØ³
    - /usr/local/bin/php artisan migrate --force

    # ğŸ”¹ Ø§Ø¬Ø±Ø§ÛŒ seed (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø²)
    # - /usr/local/bin/php artisan db:seed --force

    # ğŸ”¹ Ø¯Ø§Ø¯Ù† Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ Ø¨Ù‡ Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ÛŒ storage Ùˆ bootstrap/cache
    - chmod -R 775 storage bootstrap/cache
    - chown -R $USER:$USER storage bootstrap/cache

    # ğŸ”¹ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ cacheâ€ŒÙ‡Ø§ Ùˆ cache config Ù„Ø§Ø±Ø§ÙˆÙ„
    - /usr/local/bin/php artisan config:clear
    - /usr/local/bin/php artisan cache:clear
    - /usr/local/bin/php artisan route:clear
    - /usr/local/bin/php artisan view:clear

    # ğŸ”¹ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯Ù† Ù¾Ø±ÙˆÚ˜Ù‡
    - echo "âœ… Laravel deployment completed successfully!"

    # ğŸ”¹ Ø§Ø·Ù„Ø§Ø¹ Ø¯Ø± ØµÙˆØ±Øª backup .env
    - if [ -f ".env.backup" ]; then echo ".env backup saved"; fi
